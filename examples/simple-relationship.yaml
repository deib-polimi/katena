tosca_definitions_version: tosca_simple_yaml_1_3

imports:
- nodes/contract.yaml
- nodes/network.yaml

topology_template:
  node_templates:
    ganache:
      type: toscachain.nodes.network.ganache
    userWallet: 
      type: toscachain.nodes.network
      requirements:
      - host: ganache
      properties:
        privateKey: { get_input: UserKeyGanache }
    calleeParam:
      type: toscachain.nodes.contract
      requirements:
      - host: ganache
      - wallet: userWallet
      properties:
        abi: "CalleeLocalParams"
        parameters:
          - 1
          - "HelloWorld"
          - "0x0000000000000000000000000000000000000000"
    caller:
      type: toscachain.nodes.contract
      requirements:
      - host: ganache
      - wallet: userWallet
      - calls:
          node: calleeParam
          capability: tosca.capabilities.Callable
          relationship: increment
      properties:
        abi: "Caller"

  relationship_templates:
    increment:
      type: tosca.relationships.calls
      properties:
        modifier: "setCallee"

  inputs:
    UserKeyGanache:
      type: string
      required: true
    UserWallet:
      type: string
      required: true
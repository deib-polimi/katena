tosca_definitions_version: tosca_simple_yaml_1_3

metadata:
  template_name: "toscachain.nodes.contract"

node_types:
  toscachain.nodes.contract:
    derived_from: tosca.nodes.Root
    properties:
      abi:
        description: path to smart contract ABI
        type: string
        required: true
      privateKey:
        description: privateKey of the address that should perform the deploy
        type: string
        required: true
      address:
        description: Host IP and port
        type: string
        required: true
    interfaces:
      Standard:
        type: tosca.interfaces.node.lifecycle.Standard
        operations:
          create:
            inputs:
              abi: { type: string, default: { get_property: [SELF, abi] } }
              privateKey:
                {
                  type: string,
                  default: { get_property: [SELF, privateKey] }
                }
              network:
                { type: string, default: { get_property: [SELF, address] } }
            implementation:
              primary: playbooks/deploy_contract.yml
              dependencies:
                - scripts/
                - contracts/

topology_template:
  node_templates:
    demo:
      type: toscachain.nodes.contract
      properties:
        abi: "Demo"
        privateKey: "0x08816f2ff5ff5bbf6071252b118ffc16c465694087117b3bfa941817eb4a6460"
        address: "127.0.0.1:8545"

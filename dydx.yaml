tosca_definitions_version: tosca_simple_yaml_1_3

imports:
- nodes/contract.yaml
- nodes/network.yaml
- nodes/wallet.yaml

topology_template:
  node_templates:
    ganache:
      type: toscachain.nodes.network.ganache
    userWallet: 
      type: toscachain.nodes.wallet
      requirements:
      - host: ganache
      properties:
        privateKey: { get_input: UserKeyGanache }
        owner: { get_input: UserWallet}

    adminImpl:
      type: toscachain.nodes.contract
      requirements:
      - host: ganache
      - wallet: userWallet
      properties:
        abi: "AdminImpl"
    operationImpl:
      type: toscachain.nodes.contract
      requirements:
      - host: ganache
      - wallet: userWallet
      properties:
        abi: "OperationImpl"
    soloMargin:
      type: toscachain.nodes.contract
      requirements:
      - host: ganache
      - wallet: userWallet
      - libraries: adminImpl
      - libraries: operationImpl
      # - libraries:
          # AdminImpl: adminImpl
          # OperationImpl: operationImpl
      properties:
        abi: "SoloMargin"
        # libraries:
          # AdminImpl: { get_attribute: [adminImpl, contractAddress] }
          # OperationImpl: { get_attribute: [operationImpl, contractAddress] }
        parameters:
        - 0.15e18
        - 0.05e18
        - 0.90e18
        - 0.00
        - 2.00e18
        - 0.50e18
        - 1.00e18
        - 2.00e18
        - 2.00e18
        - 100.00e18
  
  inputs:
    UserKeyGanache:
      type: string
      required: true
    UserWallet:
      type: string
      required: true
# KATENA ⛓️ 

[![DOI](https://zenodo.org/badge/472717537.svg)](https://zenodo.org/badge/latestdoi/472717537)

Operations on Blockchain with TOSCA.

This repo contains all the files needed to setup and run the experiments used in the evaluation of KATENA.
The prototype has been tested on Ubuntu 20.04.

**NOTE**: to reproduce the experiments reported in the paper refer to [Experiments Reproducibility](#experiments-reproducibility) section. For each experiment, we provided the required step to run it.
If you want further information on how to use KATENA to deploy your applications refer to [Development](DEVELOPMENT.md) file. For extra information on Number of Tokens computation see [here](./NUMBER_OF_TOKENS.md).

## Install and run KATENA

The suggested way to reproduce the experiments is to use Docker (if not installed, check this [link](https://docs.docker.com/get-docker/)).

1. Clone this repository and navigate into the project folder
2. To build the KATENA Docker image execute
   ```
   docker build -t katena .
   ```
3. To access KATENA container execute
   ```
   docker run -it katena
   ```

## Experiments Reproducibility

The KATENA container allows to reproduce both the deployment of benchmark applications and the Number of Tokens analysis as described below.

**The following commands must be executed within KATENA containers (i.e., after the execution of step 3 of the previous section). The two experiments are independent, so there is no specific order to execute them.**

- ### Benchmark application deployment

  To deploy the benchmark applications execute within the KATENA container the following command.

  ```
  ./deploy.sh -f <topology.ylm> -c <dir_containing_abis.yml>
  ```

  The script automatically:

  - Bootstraps a Ganache instance.
  - Retrieves the credentials of Account 0 (among the ones generated by Ganache) and uses them to pay for transactions on the local Ganache Blockchain.
  - Stores these credentials in KATENA
  - Instructs KATENA to deploy the input topology

## Error logs

The errors produced by KATENA (if any) are stored in file `deploy.log`  at the  `.katena` dir.

## Repository structure

- [deploy-examples](./deploy-examples/): examples of blockchain deployments.

- [templates](./templates/): contains:

  - katena building blocks (folder `nodes`)
  - Ansible playbooks attached to xopera node and relationships types (folder `playbooks`)
  - Python scripts used to communicate with the chain (using Web3.py) (folder `scripts`)
- [contracts-examples](./contracts-examples/) Some solidity contracts used in the deploy examples
- [misc](./misc/)  miscellaneous  folder that holds a mix of different supplementary files,
